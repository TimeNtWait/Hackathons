# Skolkovo Hack 2022
4 место из 63 команд

Трек: "Разработка модели ранжирования соответствия пула кандидатов предлагаемой вакансии» от FriendWork"

https://codenrock.com/contests/skolkovo-hack-2022#/
***

# Автоматизация подбора кандидата на вакансию

## Задача: 
Определить вероятность насколько кандидаты подходят к вакансии.

Модель принимает на вход список кандидатов и вакансию, возвращает список кандидатов отсортированных по метрике (от 0 до 1) соответствия предлагаемой вакансии от максимального соответствия к минимальному.

Требования: 
Время работы ранжирования модели при входных параметрах 1 вакансия, 10 кандидатов - не более 1с

**Исходные данные:** 

- [Codenrock](https://git.codenrock.com/skolkovo-hack-2022/cnrprod-team-22497/friend-work-task/-/tree/main/result])
- [FriendWork](https://drive.google.com/file/d/1wxAfZFByX0Rf5z4OsY-khsZTxRpx_qj4/view?usp=sharing) 

***

# Решение:
## Обработка данных
### Обработка входящих данных
Первичная обработка: исходные данные именованы, удалены дубликаты, обработаны на исключение пропусков.
Обработаны выбросы в данных (такие как возраст -1 или 999). 
Даные предсталены в виде выгрузки csv файлов из реляционных БД, в связи с чем все данные объединены в одну таблицу.

* Для CatBoost подходят текстовые и категориальные данные, поэтому блока оцифровки текстов не требуется. Операция обработки текста на эмбеддингах встроена в модель.  
* Для нейронной сети TensorFlow на вход требуются оцифрованные данные. 

### Оцифровка данных и параметризация
Оцифрованы категориальные признаки (гражданство, город проживания и прочее). Категории прав выделены в отдельный параметы по категорям. Данные по образованию переведены в категории наличия среднее и/или высшего образование. Текстовое представлеине гражданства обработано в категориальный признак.  
Выполнена токенизация текстовых хакарактеристик соискателя (желаемая позиция, описание навыков) и вакансии (наименование и описание вакансии). Перед токенезацией выполнена предобработка текстовой инфомрации: убраны стоп-слова, исключены небуквенные символы, исключены короткие слова, обрезаны окончания слов и прочее 

Добалены признаки схожести (на основе коэффициента Танимото): 
- уровень схожесть между наименованием желаемой позиции кандидата и наименованием вакансии, 
- уровень схожесть между описанием навыков кандидата и описанием вакансии,
- уровень схожесть между текстовыми описаниями регионов вакансии и кандидата.

### Целевой показатель
В качестве целевого показателя выбран статус общения кандидата с работадателем. 
Статус прсдтавлен в виде текстового описание, состоящего из более 500 вариаций. 
Данный параметр разбит на группы:
- Отклонен,
- Интервью,
- На рассмотрении,
- Принят на работу.

и доплнительные продгруппы (например отклонен по здоровью, отклонен СБ и прочее.)


Варинтов когда кандидат абсолютно не подходит к вакансии (например кандидат "программист", а вакансия "тракторист") в исходных данных не представлено.
Для этого, отдельным скриптом ("generate_negative_data.py"), выполнена генерация "негативных" случаев.

##### Генерация дополнительных данных
На вход системе поданы относительно "позитивные" данные, когда кандидат был рассмотрен на должность, т.е. заведомо связанные данные вакансии и кандидата. 
Однако для поиска признака на сколько подходят вакансия и кандидат необходмио иметь негативный набор данных. 
Его можно сгенерировать из существующих данных. За основу негативных данных можно взять такие связь вакансия-кандидат, у которых схожесть в названии вакансий маскимально низкая. Такие данные занесены в отдельную группу: "Несовпадение"


В итоге целевая функция представляет собой вероятность на сколько кандидат подходит к вакансии, где "Несовпадение" имеет значение 0, а "Принят на работу" значение 1. Значения других категорий находятся между 0 и 1.   
Важно, что веса целевых категорий имеют настраиваемый характер и обеспечивают дополнительный параметр настройки процесса обучения моделей.


## Работа с моделями

При создании моделей были использованы две разные технологии: 
* **нейронная сеть** на базе библиотеки TensorFlow и модели Sequential()
* **бустинговая модель** CatBoostRegressor
Выбор данных инструментов связан с возможностями и гибкостью этих моделей. У нейронной сети можно работать с каждый слоем отдельно, тем самым подбирая оптимальные параметры для прогноза. В CatBoost реализовано огроное число настроек, благодаря которым тоже можно подстраивать модель под нужное качество.

### Процесс обучения моделей
Обе модели обучаются на собственных наборах данных.  
Процесс обучения обеих моделей логгируется с выводом сообщений в консоль Colab.  
Результатом обучения моделей являются в обоих случаях **вероятность** того, что кандидат будет принят на данную вакансию.  
Качество обучения обеих моделей проверялись на валидационной и тестовой выборках.

### Метрики качества моделей
Выбор метрик был продиктован типом задач, которые решались. Нами были использованы различные метрики:
* TensorFlow - loss-функция **binary_crossentropy**, метрика **accuracy** для задачи мультиклассовой классификации.
* CatBoost - loss-функция - **RMSE**, метрики - **ROC-AUC** и **R2**.

## Общее решение
Результатом обучения моделей является вероятность того, что кандидат будет принят на данную вакансию.
Прогнозы обеих моделей были сведены в общую таблицу. 
Данные общей таблицы обработаны по каждой вакансии отдельно - оценивались все кандидаты из тестовой выборки.
Механизм для сортировки - синтетический "рейтинг" кандидата, который зависит от 
1) региона проживания, 
2) схожести вакансии и желаемой кандидатом позиции, 
3) средне значение оценок моделей + схожести характеристик вакансии и набора харакеристик кандидата.  
"Рейтинг" - представлен в чиловом виде и для каждого кандидата вычисляется по сложной формуле.

К выдаче идет ранжированный по рейтингу в порядке убывания список кандидатов в формате candidateId - rating.

## Результаты работы
По каждой запрошенной вакансии формируется отдельный .csv файл с данными по подходящим кандидатам в порядке убывания.

# Общее 

## Файлы с исходным кодом и результатом работы
- Задача.docx - постановка задачи
- FriendWork_3.ipynb - основной файл проекта (блокнот jupyter python)
- generate_negative_data.py - генератор дополнительных данных ("негативные" случаи)
- dataset\ext_data_candidates.csv - набор входных данных расширенный "негативными" случаями
- dataset\big_ext_data_candidates.csv - набор входных данных сильно! расширенный "негативными" случаями
- result\ - директория с результирующими данными
- Презентация_SmartAnalytics_1_.pptx - презентация проекта
 
## Установка
Установка не требуется.

## Поддержка
[Черных Иван](https://t.me/iceman_o_O),  
[Мурзина Ольга](https://t.me/olga_murzina)

## TODO
Направления возможного развития: 
* добавить параметр стаж работы
* управлять весами параметров
* обработка смены статуса кандидата по одной вакансии (дублирование записей просиходит именно из-за смен статусов у кандидата-вакансии)
* анализ прохождения одной вакансии разными кандидатами
* сделать декомпозицию кода, вынести часть кода в отдельные модули, обработку данных отделить от моделирования  
``
## Используемые инструменты и технологии проекта
- [x] [Python 3.7]
- [x] [Colab]
- [x] [Pandas]
- [x] [TensorFlow]
- [x] [CatBoost]
- [x] [SkLearn]
- [x] [NLTK]

## Совместная работа обеспечивалась
- [x] [Colab]
- [x] [GoogleDrive]
- [x] [Telegram]

## Команда
1. Черных Иван Михайлович [@iceman_o_O](https://t.me/iceman_o_O)
2. Мурзина Ольга Ивановна [@olga_murzina](https://t.me/olga_murzina)
 

## License
Open source projects
